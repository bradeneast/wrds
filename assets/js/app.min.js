var __extends=this&&this.__extends||function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var l in u)u.hasOwnProperty(l)&&(s[l]=u[l])},r(t,n)};return function(t,n){r(t,n);function s(){this.constructor=t}t.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s())}}(),__makeTemplateObject=this&&this.__makeTemplateObject||function(r,t){return Object.defineProperty?Object.defineProperty(r,"raw",{value:t}):r.raw=t,r},__awaiter=this&&this.__awaiter||function(r,t,n,s){function u(l){return l instanceof n?l:new n(function(v){v(l)})}return new(n||(n=Promise))(function(l,v){function D(B){try{p(s.next(B))}catch(L){v(L)}}function E(B){try{p(s.throw(B))}catch(L){v(L)}}function p(B){B.done?l(B.value):u(B.value).then(D,E)}p((s=s.apply(r,t||[])).next())})},__generator=this&&this.__generator||function(r,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},s,u,l,v;return v={next:D(0),throw:D(1),return:D(2)},typeof Symbol==="function"&&(v[Symbol.iterator]=function(){return this}),v;function D(p){return function(B){return E([p,B])}}function E(p){if(s)throw new TypeError("Generator is already executing.");for(;n;)try{if(s=1,u&&(l=p[0]&2?u.return:p[0]?u.throw||((l=u.return)&&l.call(u),0):u.next)&&!(l=l.call(u,p[1])).done)return l;(u=0,l)&&(p=[p[0]&2,l.value]);switch(p[0]){case 0:case 1:l=p;break;case 4:return n.label++,{value:p[1],done:!1};case 5:n.label++,u=p[1],p=[0];continue;case 7:p=n.ops.pop(),n.trys.pop();continue;default:if(!(l=n.trys,l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){n=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){n.label=p[1];break}if(p[0]===6&&n.label<l[1]){n.label=l[1],l=p;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(p);break}l[2]&&n.ops.pop(),n.trys.pop();continue}p=t.call(r,n)}catch(B){p=[6,B],u=0}finally{s=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},__values=this&&this.__values||function(r){var t=typeof Symbol==="function"&&Symbol.iterator,n=t&&r[t],s=0;if(n)return n.call(r);if(r&&typeof r.length==="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(r,t){var n=typeof Symbol==="function"&&r[Symbol.iterator];if(!n)return r;var s=n.call(r),u,l=[],v;try{for(;(t===void 0||t-- >0)&&!(u=s.next()).done;)l.push(u.value)}catch(D){v={error:D}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(v)throw v.error}}return l},__spread=this&&this.__spread||function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(__read(arguments[t]));return r};(function(){var r,t,n=new WeakMap(),s=function(b){return typeof b==="function"&&n.has(b)},u=typeof window!=="undefined"&&window.customElements!=null&&window.customElements.polyfillWrapFlushCallback!==void 0,l=function(b,a,c){for(c===void 0&&(c=null);a!==c;){var e=a.nextSibling;b.removeChild(a),a=e}},v={},D={},E="{{lit-"+String(Math.random()).slice(2)+"}}",p="<!--"+E+"-->",B=new RegExp(E+"|"+p),L="$lit$",Ra=function(){function b(a,c){var e,f;this.parts=[],this.element=c;for(var g=[],i=[],j=document.createTreeWalker(c.content,133,null,!1),k=0,h=-1,m=0,o=a.strings,x=a.values.length;m<x;){var q=j.nextNode();if(q===null){j.currentNode=i.pop();continue}h++;if(q.nodeType===1){if(q.hasAttributes()){for(var y=q.attributes,H=y.length,F=0,K=0;K<H;K++)ra(y[K].name,L)&&F++;for(;F-- >0;){var K=o[m],Y=la.exec(K)[2],Z=Y.toLowerCase()+L,X=q.getAttribute(Z);q.removeAttribute(Z);var O=X.split(B);this.parts.push({type:"attribute",index:h,name:Y,strings:O}),m+=O.length-1}}q.tagName==="TEMPLATE"&&(i.push(q),j.currentNode=q.content)}else if(q.nodeType===3){var y=q.data;if(y.indexOf(E)>=0){for(var H=q.parentNode,F=y.split(B),K=F.length-1,Y=0;Y<K;Y++){var Z=void 0,X=F[Y];if(X==="")Z=P();else{var O=la.exec(X);O!==null&&ra(O[2],L)&&(X=X.slice(0,O.index)+O[1]+O[2].slice(0,-L.length)+O[3]),Z=document.createTextNode(X)}H.insertBefore(Z,q),this.parts.push({type:"node",index:++h})}F[K]===""?(H.insertBefore(P(),q),g.push(q)):q.data=F[K],m+=K}}else if(q.nodeType===8)if(q.data===E){var y=q.parentNode;(q.previousSibling===null||h===k)&&(h++,y.insertBefore(P(),q)),k=h,this.parts.push({type:"node",index:h}),q.nextSibling===null?q.data="":(g.push(q),h--),m++}else for(var y=-1;(y=q.data.indexOf(E,y+1))!==-1;)this.parts.push({type:"node",index:-1}),m++}try{for(var ka=__values(g),ba=ka.next();!ba.done;ba=ka.next()){var q=ba.value;q.parentNode.removeChild(q)}}catch(Gb){e={error:Gb}}finally{try{ba&&!ba.done&&(f=ka.return)&&f.call(ka)}finally{if(e)throw e.error}}}return b}(),ra=function(b,a){var c=b.length-a.length;return c>=0&&b.slice(c)===a},Sa=function(b){return b.index!==-1},P=function(){return document.createComment("")},la=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,sa=function(){function b(a,c,e){this.__parts=[],this.template=a,this.processor=c,this.options=e}return b.prototype.update=function(a){var c,e,f,g,i=0;try{for(var j=__values(this.__parts),k=j.next();!k.done;k=j.next()){var h=k.value;h!==void 0&&h.setValue(a[i]),i++}}catch(x){c={error:x}}finally{try{k&&!k.done&&(e=j.return)&&e.call(j)}finally{if(c)throw c.error}}try{for(var m=__values(this.__parts),o=m.next();!o.done;o=m.next()){var h=o.value;h!==void 0&&h.commit()}}catch(x){f={error:x}}finally{try{o&&!o.done&&(g=m.return)&&g.call(m)}finally{if(f)throw f.error}}},b.prototype._clone=function(){for(var a,c=u?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],f=this.template.parts,g=document.createTreeWalker(c,133,null,!1),i=0,j=0,k,h=g.nextNode();i<f.length;){k=f[i];if(!Sa(k)){this.__parts.push(void 0),i++;continue}for(;j<k.index;)j++,h.nodeName==="TEMPLATE"&&(e.push(h),g.currentNode=h.content),(h=g.nextNode())===null&&(g.currentNode=e.pop(),h=g.nextNode());if(k.type==="node"){var m=this.processor.handleTextExpression(this.options);m.insertAfterNode(h.previousSibling),this.__parts.push(m)}else(a=this.__parts).push.apply(a,__spread(this.processor.handleAttributeExpressions(h,k.name,k.strings,this.options)));i++}return u&&(document.adoptNode(c),customElements.upgrade(c)),c},b}(),Ta=" "+E+" ",ta=function(){function b(a,c,e,f){this.strings=a,this.values=c,this.type=e,this.processor=f}return b.prototype.getHTML=function(){for(var a=this.strings.length-1,c="",e=!1,f=0;f<a;f++){var g=this.strings[f],i=g.lastIndexOf("<!--");e=(i>-1||e)&&g.indexOf("-->",i+1)===-1;var j=la.exec(g);j===null?c+=g+(e?Ta:p):c+=g.substr(0,j.index)+j[1]+j[2]+L+j[3]+E}return c+=this.strings[a],c},b.prototype.getTemplateElement=function(){var a=document.createElement("template");return a.innerHTML=this.getHTML(),a},b}(),ma=function(b){return b===null||!(typeof b==="object"||typeof b==="function")},ua=function(b){return Array.isArray(b)||!!(b&&b[Symbol.iterator])},va=function(){function b(a,c,e){this.dirty=!0,this.element=a,this.name=c,this.strings=e,this.parts=[];for(var f=0;f<e.length-1;f++)this.parts[f]=this._createPart()}return b.prototype._createPart=function(){return new wa(this)},b.prototype._getValue=function(){for(var a,c,e=this.strings,f=e.length-1,g="",i=0;i<f;i++){g+=e[i];var j=this.parts[i];if(j!==void 0){var k=j.value;if(ma(k)||!ua(k))g+=typeof k==="string"?k:String(k);else try{for(var h=(a=void 0,__values(k)),m=h.next();!m.done;m=h.next()){var o=m.value;g+=typeof o==="string"?o:String(o)}}catch(x){a={error:x}}finally{try{m&&!m.done&&(c=h.return)&&c.call(h)}finally{if(a)throw a.error}}}}return g+=e[f],g},b.prototype.commit=function(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))},b}(),wa=function(){function b(a){this.value=void 0,this.committer=a}return b.prototype.setValue=function(a){a!==v&&(!ma(a)||a!==this.value)&&(this.value=a,s(a)||(this.committer.dirty=!0))},b.prototype.commit=function(){for(;s(this.value);){var a=this.value;this.value=v,a(this)}if(this.value===v)return;this.committer.commit()},b}(),xa=function(){function b(a){this.value=void 0,this.__pendingValue=void 0,this.options=a}return b.prototype.appendInto=function(a){this.startNode=a.appendChild(P()),this.endNode=a.appendChild(P())},b.prototype.insertAfterNode=function(a){this.startNode=a,this.endNode=a.nextSibling},b.prototype.appendIntoPart=function(a){a.__insert(this.startNode=P()),a.__insert(this.endNode=P())},b.prototype.insertAfterPart=function(a){a.__insert(this.startNode=P()),this.endNode=a.endNode,a.endNode=this.startNode},b.prototype.setValue=function(a){this.__pendingValue=a},b.prototype.commit=function(){if(this.startNode.parentNode===null)return;for(;s(this.__pendingValue);){var a=this.__pendingValue;this.__pendingValue=v,a(this)}var c=this.__pendingValue;if(c===v)return;ma(c)?c!==this.value&&this.__commitText(c):c instanceof ta?this.__commitTemplateResult(c):c instanceof Node?this.__commitNode(c):ua(c)?this.__commitIterable(c):c===D?(this.value=D,this.clear()):this.__commitText(c)},b.prototype.__insert=function(a){this.endNode.parentNode.insertBefore(a,this.endNode)},b.prototype.__commitNode=function(a){if(this.value===a)return;this.clear(),this.__insert(a),this.value=a},b.prototype.__commitText=function(a){var c=this.startNode.nextSibling;a=a==null?"":a;var e=typeof a==="string"?a:String(a);c===this.endNode.previousSibling&&c.nodeType===3?c.data=e:this.__commitNode(document.createTextNode(e)),this.value=a},b.prototype.__commitTemplateResult=function(a){var c=this.options.templateFactory(a);if(this.value instanceof sa&&this.value.template===c)this.value.update(a.values);else{var e=new sa(c,a.processor,this.options),f=e._clone();e.update(a.values),this.__commitNode(f),this.value=e}},b.prototype.__commitIterable=function(a){var c,e;Array.isArray(this.value)||(this.value=[],this.clear());var f=this.value,g=0,i;try{for(var j=__values(a),k=j.next();!k.done;k=j.next()){var h=k.value;i=f[g],i===void 0&&(i=new b(this.options),f.push(i),g===0?i.appendIntoPart(this):i.insertAfterPart(f[g-1])),i.setValue(h),i.commit(),g++}}catch(m){c={error:m}}finally{try{k&&!k.done&&(e=j.return)&&e.call(j)}finally{if(c)throw c.error}}g<f.length&&(f.length=g,this.clear(i&&i.endNode))},b.prototype.clear=function(a){a===void 0&&(a=this.startNode),l(this.startNode.parentNode,a.nextSibling,this.endNode)},b}(),Ua=function(){function b(a,c,e){this.value=void 0,this.__pendingValue=void 0;if(e.length!==2||e[0]!==""||e[1]!=="")throw new Error("Boolean attributes can only contain a single expression");this.element=a,this.name=c,this.strings=e}return b.prototype.setValue=function(a){this.__pendingValue=a},b.prototype.commit=function(){for(;s(this.__pendingValue);){var a=this.__pendingValue;this.__pendingValue=v,a(this)}if(this.__pendingValue===v)return;var c=!!this.__pendingValue;this.value!==c&&(c?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=c),this.__pendingValue=v},b}(),Va=function(b){__extends(a,b);function a(c,e,f){var g=b.call(this,c,e,f)||this;return g.single=f.length===2&&f[0]===""&&f[1]==="",g}return a.prototype._createPart=function(){return new Wa(this)},a.prototype._getValue=function(){return this.single?this.parts[0].value:b.prototype._getValue.call(this)},a.prototype.commit=function(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())},a}(va),Wa=function(b){__extends(a,b);function a(){return b!==null&&b.apply(this,arguments)||this}return a}(wa),ya=!1;(function(){try{var b={get capture(){return ya=!0,!1}};window.addEventListener("test",b,b),window.removeEventListener("test",b,b)}catch(a){}})();var Xa=function(){function b(a,c,e){var f=this;this.value=void 0,this.__pendingValue=void 0,this.element=a,this.eventName=c,this.eventContext=e,this.__boundHandleEvent=function(g){return f.handleEvent(g)}}return b.prototype.setValue=function(a){this.__pendingValue=a},b.prototype.commit=function(){for(;s(this.__pendingValue);){var a=this.__pendingValue;this.__pendingValue=v,a(this)}if(this.__pendingValue===v)return;var c=this.__pendingValue,e=this.value,f=c==null||e!=null&&(c.capture!==e.capture||c.once!==e.once||c.passive!==e.passive),g=c!=null&&(e==null||f);f&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),g&&(this.__options=Ya(c),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=c,this.__pendingValue=v},b.prototype.handleEvent=function(a){typeof this.value==="function"?this.value.call(this.eventContext||this.element,a):this.value.handleEvent(a)},b}(),Ya=function(b){return b&&(ya?{capture:b.capture,passive:b.passive,once:b.once}:b.capture)},Za=function(){function b(){}return b.prototype.handleAttributeExpressions=function(a,c,e,f){var g=c[0];if(g==="."){var i=new Va(a,c.slice(1),e);return i.parts}if(g==="@")return[new Xa(a,c.slice(1),f.eventContext)];if(g==="?")return[new Ua(a,c.slice(1),e)];var j=new va(a,c,e);return j.parts},b.prototype.handleTextExpression=function(a){return new xa(a)},b}(),_a=new Za();function $a(b){var a=za.get(b.type);a===void 0&&(a={stringsArray:new WeakMap(),keyString:new Map()},za.set(b.type,a));var c=a.stringsArray.get(b.strings);if(c!==void 0)return c;var e=b.strings.join(E);return c=a.keyString.get(e),c===void 0&&(c=new Ra(b,b.getTemplateElement()),a.keyString.set(e,c)),a.stringsArray.set(b.strings,c),c}var za=new Map(),Aa=new WeakMap(),T=function(b,a,c){var e=Aa.get(a);e===void 0&&(l(a,a.firstChild),Aa.set(a,e=new xa(Object.assign({templateFactory:$a},c))),e.appendInto(a)),e.setValue(b),e.commit()};typeof window!=="undefined"&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.2.1");var w=function(b){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];return new ta(b,a,"html",_a)},I=function(b){return document.getElementById(b)};function ca(){return Math.round(new Date().getTime()*Math.random())}function na(b){return b===void 0&&(b=""),b.replace(/\W+|[-_]/g,"-")}function U(b,a){var c,e,f,g,i,j,k;return __generator(this,function(h){switch(h.label){case 0:h.trys.push([0,7,8,9]),c=__values(b),e=c.next(),h.label=1;case 1:return e.done?[3,6]:(f=e.value,[4,{section:f,parent:a}]);case 2:return h.sent(),g=f.children,g?[5,__values(U(f.children,f))]:[3,4];case 3:g=h.sent(),h.label=4;case 4:g,h.label=5;case 5:return e=c.next(),[3,1];case 6:return[3,9];case 7:return i=h.sent(),j={error:i},[3,9];case 8:try{e&&!e.done&&(k=c.return)&&k.call(c)}finally{if(j)throw j.error}return[7];case 9:return[2]}})}function Q(b){var a=b.closest("section");return parseInt(a.id)}function oa(b){var a=b.closest(".field");return parseInt(a.id)}function _(b){var a,c,e;try{for(var f=__values(U(d.now.children)),g=f.next();!g.done;g=f.next()){var i=g.value,j=i.section,k=i.parent;if(j.id==b){e=j;break}}}catch(h){a={error:h}}finally{try{g&&!g.done&&(c=f.return)&&c.call(f)}finally{if(a)throw a.error}}return e}function Ba(b){var a=b.closest("section"),c=a.getAttribute("data-section-depth");return parseInt(c)}function Ca(b,a,c){var e,f=b[a]||[],g=f[c];f.splice(c,1),f.splice(c-1,0,g),A(),z(),d.hasChanged=!0,document.activeElement.blur();try{(e=document.querySelector('[id="'+g.id+'"] .moveUp'))===null||e===void 0?void 0:e.focus()}catch(i){}}function Da(b,a,c){var e,f=b[a]||[],g=f[c];f.splice(c,1),f.splice(c+1,0,g),A(),z(),d.hasChanged=!0,document.activeElement.blur();try{(e=document.querySelector('[id="'+g.id+'"] .moveDown'))===null||e===void 0?void 0:e.focus()}catch(i){}}function da(){var b,a,c,e;d.now.fieldTypes=d.now.selected.template.fieldTypes||[],d.now.globalTypes=d.now.selected.template.globalTypes||d.now.globalTypes,d.now.selected.fieldType=((c=d.now.fieldTypes)===null||c===void 0?void 0:c[0])||{},d.now.selected.globalType=((e=d.now.globalTypes)===null||e===void 0?void 0:e[0])||{};try{for(var f=__values(U(d.now.children)),g=f.next();!g.done;g=f.next()){var i=g.value,j=i.section,k=i.parent;if(!j.fields.length)continue;j.fields.map(function(h){var m;h.type=d.now.fieldTypes.find(function(o){var x;return o.id==((x=h.type)===null||x===void 0?void 0:x.id)})||((m=d.now.fieldTypes)===null||m===void 0?void 0:m[0])})}}catch(h){b={error:h}}finally{try{g&&!g.done&&(a=f.return)&&a.call(f)}finally{if(b)throw b.error}}}var ea=function(){function b(a){a===void 0&&(a=0),this.id=ca(),this.depth=a,this.text="",this.html="",this.children=[],this.fields=[]}return b}(),Ea=function(){function b(){this.id=ca(),this.value="",this.type=0}return b}(),Fa=function(){function b(a){this.id=ca(),this.name=a,this.css=""}return b}(),Ga=function(){function b(a){this.id=ca(),this.name=a}return b}(),Ha=function(b){__extends(a,b);function a(c){var e=b.call(this,c)||this;return e.type="field type",e.css="",e}return a}(Ga),Ia=function(b){__extends(a,b);function a(c){var e=b.call(this,c)||this;return e.type="template",e.fieldTypes=[],e.globalTypes=[],e}return a}(Ga),R=["Chapter","Section","Block"],fa={h1:"Lvl 1 Heading",h2:"Lvl 2 Heading",h3:"Lvl 3 Heading",h4:"Lvl 4 Heading",h5:"Lvl 5 Heading",h6:"Lvl 6 Heading",hr:"Horizontal Rules",p:"Paragraph",blockquote:"Block Quote",ul:"Unordered List",ol:"Ordered List",li:"List Item",a:"Link",strong:"Bolded Text",em:"Italic Text",code:"Code",img:"Image"},G={previewPane:I("preview"),toolbar:I("toolbar"),contentEditorPane:I("content_editor"),styleEditorPane:I("style_editor"),modal:I("modal"),customStyles:I("custom_styles"),walkThroughDialogue:I("walkthrough_dialogue"),mobileNav:I("mobile_nav")},V={throttle:60,mobileBreakpoint:960,saveInterval:2000,zoom:{min:.5,max:2,interval:.1}},Ja;try{Ja=JSON.parse(localStorage.getItem("State"))}catch(b){console.log("No previous data found.")}var d=Ja||{now:{children:[],fieldTypes:[],globalTypes:R.map(function(b){return new Fa(b)}).concat(Object.values(fa).map(function(b){return new Fa(b)})),selected:{fieldType:{},globalType:{},template:{}},editing:{}},nowIndex:0,settings:{zoom:1,darkMode:!1,advancedUI:!1,messagesShown:!1},walkthroughIndex:0,history:[],templates:[],hasChanged:!1,isNewUser:!0,isMobile:innerWidth<=V.mobileBreakpoint,lastSaved:new Date(),forExport:""},ab=function(b){var a,c,e,f=Q(b.target),g=Ba(b.target),i;try{for(var j=__values(U(d.now.children,d.now)),k=j.next();!k.done;k=j.next()){var h=k.value,m=h.section,o=h.parent;if(m.id==f){var x=new ea(g);o.children.push(x),i=x.id;break}}}catch(q){a={error:q}}finally{try{k&&!k.done&&(c=j.return)&&c.call(j)}finally{if(a)throw a.error}}d.hasChanged=!0,A(),d.isMobile||((e=document.querySelector('[id="'+i+'"] textarea'))===null||e===void 0?void 0:e.focus())},bb=function(b){var a,c,e,f=Q(b.target),g=Ba(b.target),i;try{for(var j=__values(U(d.now.children,d.now)),k=j.next();!k.done;k=j.next()){var h=k.value,m=h.section,o=h.parent;if(m.id==f){var x=new ea(g+1);m.children.unshift(x),i=x.id;break}}}catch(q){a={error:q}}finally{try{k&&!k.done&&(c=j.return)&&c.call(j)}finally{if(a)throw a.error}}d.hasChanged=!0,A(),d.isMobile||((e=document.querySelector('[id="'+i+'"] textarea'))===null||e===void 0?void 0:e.focus())},cb=function(b){var a,c,e=Q(b.target),f=function(m,o){if(m.id!=e)return"continue";o.children=o.children.filter(function(x){return x!=m})};try{for(var g=__values(U(d.now.children,d.now)),i=g.next();!i.done;i=g.next()){var j=i.value,k=j.section,h=j.parent;f(k,h)}}catch(m){a={error:m}}finally{try{i&&!i.done&&(c=g.return)&&c.call(g)}finally{if(a)throw a.error}}d.hasChanged=!0,z(),A()},db=function(b){var a=Q(b.target),c=_(a);c.text=b.target.value,d.hasChanged=!0,z()},ga={addSiblingSection:ab,addChildSection:bb,removeSection:cb,updateSection:db},eb=function(b){var a,c=Q(b.target),e=_(c),f=new Ea();f.type=d.now.fieldTypes[0],e.fields.push(f),d.hasChanged=!0,A(),d.isMobile||((a=document.querySelector('[id="'+f.id+'"] input'))===null||a===void 0?void 0:a.focus())},fb=function(b){var a=Q(b.target),c=_(a),e=oa(b.target);c.fields=c.fields.filter(function(f){return f.id!=e}),d.hasChanged=!0,A(),z()},gb=function(b){var a=Q(b.target),c=_(a),e=oa(b.target),f=c.fields.find(function(g){return g.id==e});f.value=b.target.value,d.hasChanged=!0,z()},hb=function(b){var a=b.target.value,c=oa(b.target),e=Q(b.target),f=_(e),g=f.fields.find(function(i){return i.id==c});g.type=d.now.fieldTypes.find(function(i){return i.id==a}),d.hasChanged=!0,z()},ha={addField:eb,removeField:fb,updateFieldValue:gb,updateFieldType:hb},ib=function(b){var a=b.target.textContent||"";b.target.id.includes("global")&&(d.now.selected.globalType.css=a,d.hasChanged=!0),b.target.id.includes("field")&&(d.now.selected.fieldType.css=a,d.hasChanged=!0),S()},pa=function(b){var a=b.target||b,c=function(e,f){return'<span class="token '+f+'">'+e+"</span>"};a.innerHTML=a.innerText.replace(/\n/g,"").replace(/;/g,c(";","newline")).replace(/[,:](?!\s)/g,function(e){return e+" "})},jb=function(b){var a=b.target.value,c=I("field_type_styles"),e=d.now.fieldTypes.find(function(g){return g.id==a});if(e)e.css||(e.css=""),d.now.selected.fieldType=e;else{var f={id:a,css:""};d.now.fieldTypes.push(f),d.now.selected.fieldType=f}c.innerHTML=d.now.selected.fieldType.css,pa(c),d.hasChanged=!0,z()},kb=function(b){var a=I("global_type_styles"),c=b.target.value,e=d.now.globalTypes.find(function(g){return g.name==c});if(e)e.css||(e.css=""),d.now.selected.globalType=e;else{var f={id:c,css:""};d.now.globalTypes.push(f),d.now.selected.globalType=f}a.innerHTML=d.now.selected.globalType.css,pa(a),d.hasChanged=!0,z()},W={updateStyles:ib,updateCurrentFieldType:jb,updateCurrentGlobalType:kb,formatCSS:pa},lb=function(b){var a,c;if(b=="template"){d.templates=d.templates.filter(function(e){return JSON.parse(e).id!=d.now.selected.template.id});try{d.now.selected.template=JSON.parse((a=d.templates)===null||a===void 0?void 0:a[0])||{}}catch(e){}}b=="field type"&&(d.now.fieldTypes=d.now.fieldTypes.filter(function(e){return e.id!=d.now.selected.fieldType.id}),d.now.selected.template.fieldTypes=d.now.fieldTypes,d.now.selected.fieldType=((c=d.now.fieldTypes)===null||c===void 0?void 0:c[0])||{}),d.now.editing={},d.hasChanged=!0,M(null),A(),C(),N(),S(),z()},mb=function(b){var a;d.now.editing[b.target.name]=b.target.value,((a=d.now.editing)===null||a===void 0?void 0:a.type)=="template"&&d.templates.map(function(c,e){var f=JSON.parse(c),g=f.id==d.now.editing.id;g&&d.templates.splice(e,1,JSON.stringify(d.now.editing))}),d.hasChanged=!0,A(),C(),N(),S()},nb=function(){var b,a;d.now.selected.fieldType=d.now.fieldTypes[d.now.fieldTypes.length-1],d.now.selected.template.fieldTypes=d.now.fieldTypes;if(d.now.fieldTypes.length==1)try{for(var c=__values(U(d.now.children)),e=c.next();!e.done;e=c.next()){var f=e.value,g=f.section,i=f.parent;g.fields.map(function(j){return j.type=d.now.fieldTypes[0]})}}catch(j){b={error:j}}finally{try{e&&!e.done&&(a=c.return)&&a.call(c)}finally{if(b)throw b.error}}},ob=function(b){var a;d.now.editing.name=d.now.editing.name.trim();if(!d.now.editing.name.length){M(null);return}b=="field type"&&(d.now.fieldTypes.push(new Ha(d.now.editing.name)),nb(),(a=G.styleEditorPane.querySelector("code"))===null||a===void 0?void 0:a.focus());if(b=="template"){var c=new Ia(d.now.editing.name);c.fieldTypes=d.now.fieldTypes,c.globalTypes=d.now.globalTypes,d.templates.push(JSON.stringify(c)),d.now.selected.template=c}d.now.editing={},d.hasChanged=!0,A(),C(),z(),N(),M(null)},qa={removeType:lb,updateType:mb,saveNewType:ob},pb=function(b){var a=d.settings.darkMode;document.documentElement.classList.toggle("dark_mode",!a),d.settings.darkMode=!a,d.hasChanged=!0,C()},qb=function(b){var a=d.settings.advancedUI;document.documentElement.classList.toggle("advanced",!a),d.settings.advancedUI=!a,d.hasChanged=!0,C()},Ka=function(b){var a,c;if(!confirm("Are you sure you want to load this template?"))return;try{for(var e=__values(d.templates),f=e.next();!f.done;f=e.next()){var g=f.value,i=JSON.parse(g);if(i.id==b.target.value){d.now.selected.template=i,da(),A(),C(),z(),N(),S(),d.hasChanged=!0;break}}}catch(j){a={error:j}}finally{try{f&&!f.done&&(c=e.return)&&c.call(e)}finally{if(a)throw a.error}}},rb=function(b){return window.print()},sb=function(b){var a=b.target.files[0],c=new FileReader();c.onerror=function(){console.error(this.error)},c.onload=function(){var e=JSON.parse(this.result);Object.keys(d).map(function(f){return d[f]=e[f]}),da(),A(),C(),z(),N(),S()},document.body.classList.add("importing"),c.readAsText(a)},tb=function(b){d.now.children=[],d.now.fieldTypes=[],d.now.editing={},d.now.selected={fieldType:{},globalType:{},template:{}},d.templates=[],d.settings={zoom:1,darkMode:!1,advancedUI:!1},A(),C(),z(),N(),S(),d.now.children.push(new ea()),A(),d.hasChanged=!0},ub=function(b){document.body.setAttribute("data-selected-pane",b)},vb=function(b){b===void 0&&(b="");var a=b.toLowerCase(),c=d.settings.zoom;a=="out"&&c>V.zoom.min&&(c=c-V.zoom.interval),a=="in"&&c<V.zoom.max&&(c=c+V.zoom.interval),c!=d.settings.zoom&&(d.settings.zoom=c,d.hasChanged=!0,C())},J={toggleDarkMode:pb,toggleAdvancedUI:qb,loadTemplate:Ka,printDocument:rb,importData:sb,clearData:tb,switchPane:ub,zoom:vb},La=function(b){var a=b===void 0?{}:b,c=a.global,e=c===void 0?!1:c,f=a.field,g=f===void 0?{}:f,i,j,k,h;if(!((i=d.now.fieldTypes)===null||i===void 0?void 0:i.length))return;var m=e?(j=d.now.selected.fieldType)===null||j===void 0?void 0:j.id:(h=(k=g)===null||k===void 0?void 0:k.type)===null||h===void 0?void 0:h.id;return w(__makeTemplateObject([`
    <select name=type @input=`,`>

        `,`

    </select>`],[`
    <select name=type @input=`,`>

        `,`

    </select>`]),e?W.updateCurrentFieldType:ha.updateFieldType,d.now.fieldTypes.map(function(o){return w(__makeTemplateObject([`
            <option value=`," ?selected=",`>
                `,`
            </option>
        `],[`
            <option value=`," ?selected=",`>
                `,`
            </option>
        `]),o.id,o.id==m,o.name)}))},wb=function(b,a,c){return w(__makeTemplateObject([`
<div 
class=field 
id=`,`>

    <input 
    placeholder="Field value..."
    type=text 
    .value=`,` 
    @input=`,` />

    `,`

    <button 
    @click=`,` 
    class=remove>
        Remove
    </button>

    <button
    data-icon
    @click=`,`
    ?disabled=`,`
    class="move moveDown">
    </button>

    <button
    data-icon
    @click=`,`
    ?disabled=`,` 
    class="move moveUp">
    </button>

</div>`],[`
<div 
class=field 
id=`,`>

    <input 
    placeholder="Field value..."
    type=text 
    .value=`,` 
    @input=`,` />

    `,`

    <button 
    @click=`,` 
    class=remove>
        Remove
    </button>

    <button
    data-icon
    @click=`,`
    ?disabled=`,`
    class="move moveDown">
    </button>

    <button
    data-icon
    @click=`,`
    ?disabled=`,` 
    class="move moveUp">
    </button>

</div>`]),b.id,b.value,ha.updateFieldValue,La({field:b}),ha.removeField,Da.bind(void 0,a,"fields",c),c>=a.fields.length-1,Ca.bind(void 0,a,"fields",c),!c)};function Ma(b,a,c){var e=d.now.children.length,f=b.depth,g=f==R.length-1;return w(__makeTemplateObject([`
    <section 
    id=`,` 
    data-section-depth=`,`>

        <div class=fields>
            `,`
        </div>

        <textarea 
        id="`,`-text"
        placeholder=`,` 
        @input=`,` 
        .value=`,`>
        </textarea>

        <div class=actions>

            <button 
            data-icon=add_another
            title=`,`
            @click=`,`>
            </button>

            `,`

            <button 
            class=add
            data-icon
            title="Add Field"
            @click=`,`>
            </button>

            `,`

            `,`

        </div>

        `,`

    </section>`],[`
    <section 
    id=`,` 
    data-section-depth=`,`>

        <div class=fields>
            `,`
        </div>

        <textarea 
        id="`,`-text"
        placeholder=`,` 
        @input=`,` 
        .value=`,`>
        </textarea>

        <div class=actions>

            <button 
            data-icon=add_another
            title=`,`
            @click=`,`>
            </button>

            `,`

            <button 
            class=add
            data-icon
            title="Add Field"
            @click=`,`>
            </button>

            `,`

            `,`

        </div>

        `,`

    </section>`]),b.id,b.depth,b.fields.map(function(i,j){return wb(i,b,j)}),b.id,"Write something for this "+R[f].toLowerCase()+"...",ga.updateSection,b.text,"Add "+R[f],ga.addSiblingSection,g?"":w(__makeTemplateObject([`
            <button 
            data-icon=add_sub
            title=`,`
            @click=`,`>
            </button>`],[`
            <button 
            data-icon=add_sub
            title=`,`
            @click=`,`>
            </button>`]),"Add "+R[f+1],ga.addChildSection),ha.addField,e>1||f?w(__makeTemplateObject([`
            <button 
            class=remove
            @click=`,`>
            Remove
            </button>`],[`
            <button 
            class=remove
            @click=`,`>
            Remove
            </button>`]),ga.removeSection):"",a.children.length>1?w(__makeTemplateObject([`

            <button 
            class="move moveDown" 
            data-icon
            title="Move Down"
            ?disabled=`,` 
            @click=`,`>
            </button>

            <button 
            class="move moveUp"
            data-icon
            title="Move Up"
            ?disabled=`,` 
            @click=`,`>
            </button>
            
            `],[`

            <button 
            class="move moveDown" 
            data-icon
            title="Move Down"
            ?disabled=`,` 
            @click=`,`>
            </button>

            <button 
            class="move moveUp"
            data-icon
            title="Move Up"
            ?disabled=`,` 
            @click=`,`>
            </button>
            
            `]),c>=a.children.length-1,Da.bind(this,a,"children",c),!c,Ca.bind(this,a,"children",c)):"",b.children.length?b.children.map(function(i,j){return Ma(i,b,j)}):"")}var xb={"":["<em>","</em>"],_:["<strong>","</strong>"],"*":["<strong>","</strong>"],"~":["<s>","</s>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function Na(b){return b.replace(RegExp("^"+(b.match(/^(\t| )+/)||"")[0],"gm"),"")}function $(b){return(b+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ia(b,a){var c=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,e=[],f="",g=a||{},i=0,j,k,h,m,o;function x(y){var H=xb[y[1]||""],F=e[e.length-1]==y;return H?H[1]?(F?e.pop():e.push(y),H[F|0]):H[0]:y}function q(){for(var y="";e.length;)y+=x(e[e.length-1]);return y}for(b=b.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(y,H,F){return g[H.toLowerCase()]=F,""}).replace(/^\n+|\n+$/g,"");h=c.exec(b);)k=b.substring(i,h.index),i=c.lastIndex,j=h[0],k.match(/[^\\](\\\\)*\\$/)||((o=h[3]||h[4])?j='<pre class="code '+(h[4]?"poetry":h[2].toLowerCase())+'"><code'+(h[2]?' class="language-'+h[2].toLowerCase()+'"':"")+">"+Na($(o).replace(/^\n+|\n+$/g,""))+"</code></pre>":(o=h[6])?(o.match(/\./)&&(h[5]=h[5].replace(/^\d+/gm,"")),m=ia(Na(h[5].replace(/^\s*[>*+.-]/gm,""))),o==">"?o="blockquote":(o=o.match(/\./)?"ol":"ul",m=m.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),j="<"+o+">"+m+"</"+o+">"):h[8]?j='<img src="'+$(h[8])+'" alt="'+$(h[7])+'">':h[10]?(f=f.replace("<a>",'<a href="'+$(h[11]||g[k.toLowerCase()])+'">'),j=q()+"</a>"):h[9]?j="<a>":h[12]||h[14]?(o="h"+(h[14]?h[14].length:h[13]>"="?1:2),j="<"+o+">"+ia(h[12]||h[15],g)+"</"+o+">"):h[16]?j="<code>"+$(h[16])+"</code>":(h[17]||h[1])&&(j=x(h[17]||"--"))),f+=k,f+=j;return(f+b.substring(i)+q()).replace(/^\n+|\n+$/g,"")}var yb=function(b){var a,c=d.now.fieldTypes.find(function(f){var g,i;return f.id==((i=(g=b)===null||g===void 0?void 0:g.type)===null||i===void 0?void 0:i.id)}),e=document.createElement("div");return e.innerHTML=ia(b.value),/<p>/.test(e.innerHTML)&&(e.innerHTML=e.firstElementChild.innerHTML),w(__makeTemplateObject([`
    <div class=`,`>
        `,`
    </div>`],[`
    <div class=`,`>
        `,`
    </div>`]),na(((a=c)===null||a===void 0?void 0:a.name)||""),e)};function Oa(b){var a=document.createElement("div");return a.classList.add("content"),a.innerHTML=ia(b.text),w(__makeTemplateObject([`
    <section class=`,`>
    
        `,`
    
        `,`
    
        `,`
    
    </section>`],[`
    <section class=`,`>
    
        `,`
    
        `,`
    
        `,`
    
    </section>`]),R[b.depth],b.fields.map(function(c){return yb(c)}),b.text.length?a:"",b.children.map(function(c){return Oa(c)}))}var zb=function(){var b;return w(__makeTemplateObject([`

<div class="heading">
    Style Editor
    <span tabindex="0" data-tooltip="This pane is for editing your document's styles. Apply valid CSS rules to any custom field type or global element."></span>
</div>

<section id=manageFieldTypes>

    <div class=actions>

        <label>Field Styles</label>

        `,`

        `,`

        <button 
        class=add 
        data-icon
        title="New Field Type"
        @click=`,`>
        </button>
        
    </div>

    <code 
    spellcheck=false
    id=field_type_styles
    class=language-css 
    contenteditable=true 
    @focusout=`,`
    @keyup=`,`></code>
    
</section>


<section id=manageGlobalTypes>

    <div class=actions>

        <label>Global Styles</label>

        <select id=global-style-select @input=`,`>

            <optgroup label=Layout>
            `,`
            </optgroup>

            <optgroup label=Elements>
                `,`
            </optgroup>
        </select>

    </div>

    <code
    spellcheck=false
    id=global_type_styles
    class=language-css
    contenteditable=true
    @focusout=`,`
    @keyup=`,`></code>

</section>
`],[`

<div class="heading">
    Style Editor
    <span tabindex="0" data-tooltip="This pane is for editing your document's styles. Apply valid CSS rules to any custom field type or global element."></span>
</div>

<section id=manageFieldTypes>

    <div class=actions>

        <label>Field Styles</label>

        `,`

        `,`

        <button 
        class=add 
        data-icon
        title="New Field Type"
        @click=`,`>
        </button>
        
    </div>

    <code 
    spellcheck=false
    id=field_type_styles
    class=language-css 
    contenteditable=true 
    @focusout=`,`
    @keyup=`,`></code>
    
</section>


<section id=manageGlobalTypes>

    <div class=actions>

        <label>Global Styles</label>

        <select id=global-style-select @input=`,`>

            <optgroup label=Layout>
            `,`
            </optgroup>

            <optgroup label=Elements>
                `,`
            </optgroup>
        </select>

    </div>

    <code
    spellcheck=false
    id=global_type_styles
    class=language-css
    contenteditable=true
    @focusout=`,`
    @keyup=`,`></code>

</section>
`]),La({global:!0}),((b=d.now.fieldTypes)===null||b===void 0?void 0:b.length)?w(__makeTemplateObject([`
        <button 
        data-icon
        title="Edit Field Type"
        @click=`,`>
        </button>`],[`
        <button 
        data-icon
        title="Edit Field Type"
        @click=`,`>
        </button>`]),M.bind(void 0,"field type",!0)):"",M.bind(void 0,"field type",!1),W.formatCSS,W.updateStyles,W.updateCurrentGlobalType,R.map(function(a){var c;return w(__makeTemplateObject([`
                <option
                value=`,`
                ?selected=`,`>
                    `,`s
                </option>
            `],[`
                <option
                value=`,`
                ?selected=`,`>
                    `,`s
                </option>
            `]),a,a==((c=d.now.selected.globalType)===null||c===void 0?void 0:c.name),a)}),Object.values(fa).map(function(a){var c;return w(__makeTemplateObject([`
                    <option 
                    label=`,`
                    value=`,`
                    ?selected=`,`>
                        `,`s
                    </option>
                `],[`
                    <option 
                    label=`,`
                    value=`,`
                    ?selected=`,`>
                        `,`s
                    </option>
                `]),a,a,a==((c=d.now.selected.globalType)===null||c===void 0?void 0:c.name),a)}),W.formatCSS,W.updateStyles)},Ab=function(){return w(__makeTemplateObject([`

`,`

`,`

`,`
`],[`

`,`

`,`

`,`
`]),d.now.fieldTypes.map(function(b){return"#preview ."+na(b.name).trim()+"{"+b.css+"}"}),R.map(function(b){var a,c=d.now.globalTypes.find(function(e){return e.name==b});return"#preview ."+na(b).trim()+"{"+((a=c)===null||a===void 0?void 0:a.css)+"}"}),Object.keys(fa).map(function(b){var a,c=fa[b],e=d.now.globalTypes.find(function(f){return f.name==c});return"#preview "+b+" {"+((a=e)===null||a===void 0?void 0:a.css)+"}"}))},Pa=function(b){b===void 0&&(b=0);var a=d.nowIndex+b;d.now=JSON.parse(d.history[a]),d.nowIndex=a,da(),A(),C(),z(),N(),S()},Bb=function(){var b,a=d.settings;return w(__makeTemplateObject([`


    <!-- Undo/Redo -->
    <div class=configuration id=undo_redo>

        <button
        data-icon
        title=Undo
        ?disabled=`,`
        @click=`,`>
        </button>

        <button
        data-icon
        title=Redo
        ?disabled=`,`
        @click=`,`>
        </button>

    </div>


    <!-- Zoom -->
    <div class=configuration id=zoom>

        <button
        data-icon
        title="Zoom Out"
        @click=`,`>
        </button>

        <button
        data-icon
        title="Zoom In"
        @click=`,`>
        </button>

        <label>`,`</label>

    </div>
    

    <!-- Toggle Dark Mode -->
    <div class=configuration>

        <button 
        data-icon 
        title=`,`
        ?aria-pressed=`,`
        @click=`,`
        id=dark_mode_toggle>
        </button>

    </div>
    

    <!-- Toggle Advanced UI -->
    <div class=configuration id=advancedUI_toggle>

        <button
        data-icon
        id="advanced_toggle"
        ?aria-pressed=`,`
        title=`,`
        @click=`,`>
        </button>

    </div>
    

    <!-- Template Management -->
    <div class=configuration id=manageTemplates>

        <!-- Select Template -->
    `,`

        <!-- Save New Template -->
        <button
        data-icon
        title="New Template"
        @click=`,`>
        </button>

    </div>


    <!-- Print Document -->
    <div class=configuration id=printDocument>
        <button 
        data-icon
        title=Print
        @click=`,`>
        </button>
    </div>


    <!-- Import and Export Data -->
    <div class=configuration id=import_export>

        <a 
        class="button primary"
        data-icon
        title="Export Data"
        id=exportData
        .href=`,`
        download=`,`
        >
        </a>

        <input
        aria-hidden="true"
        id=importData
        type=file
        accept=.json
        @input=`,`>

        <label 
        data-icon
        title="Import Data"
        class="fileInput secondary"
        for=importData>
        </label>

        <!-- Clear Data -->
        <button
        data-icon
        title="Clear Data"
        class=destructive
        @click=`,`>
        </button>

    </div>


    <!-- Last Saved -->
    `,`
    `],[`


    <!-- Undo/Redo -->
    <div class=configuration id=undo_redo>

        <button
        data-icon
        title=Undo
        ?disabled=`,`
        @click=`,`>
        </button>

        <button
        data-icon
        title=Redo
        ?disabled=`,`
        @click=`,`>
        </button>

    </div>


    <!-- Zoom -->
    <div class=configuration id=zoom>

        <button
        data-icon
        title="Zoom Out"
        @click=`,`>
        </button>

        <button
        data-icon
        title="Zoom In"
        @click=`,`>
        </button>

        <label>`,`</label>

    </div>
    

    <!-- Toggle Dark Mode -->
    <div class=configuration>

        <button 
        data-icon 
        title=`,`
        ?aria-pressed=`,`
        @click=`,`
        id=dark_mode_toggle>
        </button>

    </div>
    

    <!-- Toggle Advanced UI -->
    <div class=configuration id=advancedUI_toggle>

        <button
        data-icon
        id="advanced_toggle"
        ?aria-pressed=`,`
        title=`,`
        @click=`,`>
        </button>

    </div>
    

    <!-- Template Management -->
    <div class=configuration id=manageTemplates>

        <!-- Select Template -->
    `,`

        <!-- Save New Template -->
        <button
        data-icon
        title="New Template"
        @click=`,`>
        </button>

    </div>


    <!-- Print Document -->
    <div class=configuration id=printDocument>
        <button 
        data-icon
        title=Print
        @click=`,`>
        </button>
    </div>


    <!-- Import and Export Data -->
    <div class=configuration id=import_export>

        <a 
        class="button primary"
        data-icon
        title="Export Data"
        id=exportData
        .href=`,`
        download=`,`
        >
        </a>

        <input
        aria-hidden="true"
        id=importData
        type=file
        accept=.json
        @input=`,`>

        <label 
        data-icon
        title="Import Data"
        class="fileInput secondary"
        for=importData>
        </label>

        <!-- Clear Data -->
        <button
        data-icon
        title="Clear Data"
        class=destructive
        @click=`,`>
        </button>

    </div>


    <!-- Last Saved -->
    `,`
    `]),d.nowIndex==0,Pa.bind(void 0,-1),d.nowIndex>=d.history.length-1,Pa.bind(void 0,1),J.zoom.bind(void 0,"out"),J.zoom.bind(void 0,"in"),"("+Math.round(a.zoom*100)+"%)","You're in "+(a.darkMode?"Dark":"Light")+" Mode",a.darkMode,J.toggleDarkMode,a.advancedUI,(a.advancedUI?"Disable":"Enable")+" Advanced UI",J.toggleAdvancedUI,d.templates.length?w(__makeTemplateObject([`
        <select 
        title=`,` 
        @input=`,`>

    `,`

        </select>

        <!-- Edit Template -->
        <button
        data-icon
        title="Edit Template"
        @click=`,`>
        </button>

        `],[`
        <select 
        title=`,` 
        @input=`,`>

    `,`

        </select>

        <!-- Edit Template -->
        <button
        data-icon
        title="Edit Template"
        @click=`,`>
        </button>

        `]),"Current Template: "+d.now.selected.template.name,Ka,d.templates.map(function(c){var e=JSON.parse(c),f=d.now.selected.template.id==e.id;return w(__makeTemplateObject([`
            <option 
            ?selected=`,`
            value=`,`>
                `,`
            </option>`],[`
            <option 
            ?selected=`,`
            value=`,`>
                `,`
            </option>`]),f,e.id,e.name)}),M.bind(void 0,"template",!0)):D,M.bind(void 0,"template",!1),J.printDocument,(b=d)===null||b===void 0?void 0:b.forExport,"My Data ("+new Date(d.lastSaved).toLocaleDateString()+").json",J.importData,J.clearData,d.lastSaved?w(__makeTemplateObject([`
    <div class=configuration>
            Saved: `,`
    </div>
    `],[`
    <div class=configuration>
            Saved: `,`
    </div>
    `]),new Date(d.lastSaved).toLocaleTimeString("en-us",{timeStyle:"short"})):D)},Cb=function(b,a){return b?(b=="field type"&&(d.now.editing=a?d.now.selected.fieldType:new Ha()),b=="template"&&(d.now.editing=a?d.now.selected.template:new Ia()),w(__makeTemplateObject([`
    <div class=content>
        
        <div class=heading>
            `,` Editor
            <span
            tabindex=0 
            data-tooltip=`,`>
            </span>
        </div>

        <input 
        name=name 
        @input=`,` 
        type=text 
        placeholder=`,`
        value=`,` />
        
        <div class=actions>

            <button 
            @click=`,`>
                Done
            </button>

            `,`

            <button 
            class=cancel 
            @click=`,`>
                Cancel
            </button>
            
        </div>

    </div>`],[`
    <div class=content>
        
        <div class=heading>
            `,` Editor
            <span
            tabindex=0 
            data-tooltip=`,`>
            </span>
        </div>

        <input 
        name=name 
        @input=`,` 
        type=text 
        placeholder=`,`
        value=`,` />
        
        <div class=actions>

            <button 
            @click=`,`>
                Done
            </button>

            `,`

            <button 
            class=cancel 
            @click=`,`>
                Cancel
            </button>
            
        </div>

    </div>`]),d.now.editing.type,"This pane is for renaming or editing your "+d.now.editing.type+".",qa.updateType,"Name your "+d.now.editing.type+"...",a?d.now.editing.name:"",a?M.bind(void 0,null):qa.saveNewType.bind(void 0,d.now.editing.type),a?w(__makeTemplateObject([`
            <button 
            class=remove 
            @click=`,`>
                Delete `,`
            </button>`],[`
            <button 
            class=remove 
            @click=`,`>
                Delete `,`
            </button>`]),qa.removeType.bind(void 0,d.now.editing.type),d.now.editing.type):"",M.bind(void 0,null))):""},Db=function(){return w(__makeTemplateObject([`

<button 
data-icon
title="Switch to Content Editor" 
@click=`,`>
</button>

<button
data-icon
title="Switch to Preview"
@click=`,`>
</button>

<button
data-icon
title="Switch to Style Editor"
@click=`,`>
</button>

`],[`

<button 
data-icon
title="Switch to Content Editor" 
@click=`,`>
</button>

<button
data-icon
title="Switch to Preview"
@click=`,`>
</button>

<button
data-icon
title="Switch to Style Editor"
@click=`,`>
</button>

`]),J.switchPane.bind(void 0,"content_editor"),J.switchPane.bind(void 0,"preview"),J.switchPane.bind(void 0,"style_editor"))};function z(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){return T(w(__makeTemplateObject([`
        <div class=content>
            `,`
        </div>`],[`
        <div class=content>
            `,`
        </div>`]),d.now.children.map(function(a){return Oa(a)})),G.previewPane),[2]})})}function C(){return __awaiter(this,void 0,void 0,function(){var b;return __generator(this,function(a){return b=document.documentElement,b.style.setProperty("--preview_zoom",d.settings.zoom),b.classList.toggle("dark_mode",d.settings.darkMode),b.classList.toggle("advanced",d.settings.advancedUI),T(Bb(),G.toolbar),[2]})})}function S(){T(Ab(),G.customStyles)}function M(b,a){a===void 0&&(a=!1),G.modal.classList.toggle("open",b),T(Cb(b,a),G.modal);if(b)try{G.modal.querySelector("input").focus()}catch(c){}b||(d.now.editing={},C(),N(),z())}function N(){var b,a,c,e,f;T(zb(),G.styleEditorPane);try{for(var g=__values(G.styleEditorPane.querySelectorAll("code")),i=g.next();!i.done;i=g.next()){var j=i.value;j.innerHTML="",j.id.includes("field")&&(j.innerText=((c=d.now.selected.fieldType)===null||c===void 0?void 0:c.css)||""),j.id.includes("global")&&(j.innerText=((e=d.now.selected.globalType)===null||e===void 0?void 0:e.css)||""),(f=W)===null||f===void 0?void 0:f.formatCSS({target:j})}}catch(k){b={error:k}}finally{try{i&&!i.done&&(a=g.return)&&a.call(g)}finally{if(b)throw b.error}}}function A(){T(w(__makeTemplateObject([`
        <div class=heading>
            Content Editor
            <span tabindex=0
                data-tooltip="This pane is for editing the content of your document. Try nesting content blocks or adding custom fields to a section."></span>
        </div>
        
        `,`
        `],[`
        <div class=heading>
            Content Editor
            <span tabindex=0
                data-tooltip="This pane is for editing the content of your document. Try nesting content blocks or adding custom fields to a section."></span>
        </div>
        
        `,`
        `]),d.now.children.map(function(b,a){return Ma(b,d.now,a)})),G.contentEditorPane)}function Eb(){T(Db(),G.mobileNav)}function Qa(b){return b===void 0&&(b=!1),__awaiter(this,void 0,void 0,function(){var a,c,e;return __generator(this,function(f){return!d.hasChanged&&!b?[2]:(d.templates.map(function(g,i){var j=JSON.parse(g),k=j.id==d.now.selected.template.id;k&&d.templates.splice(i,1,JSON.stringify(d.now.selected.template))}),localStorage.setItem("State",JSON.stringify(d)),d.history.push(JSON.stringify(d.now)),d.nowIndex=d.history.length-1,d.history.length>250&&d.history.splice(0,1),d.hasChanged=!1,d.lastSaved=new Date().getTime(),a=JSON.stringify(d,function(g,i){return g=="history"?[]:i}),c=new Blob([a],{type:"application/json"}),e=URL.createObjectURL(c),d.forExport=e,C(),[2])})})}d.isNewUser&&!d.now.children.length&&(d.now.children.push(new ea()),d.now.children[0].fields.push(new Ea()),Qa(!0)),da(),A(),C(),z(),N(),Eb(),S(),setInterval(Qa,V.saveInterval),document.body.classList.remove("loading"),d.isMobile=innerWidth<V.mobileBreakpoint;try{for(var ja=__values(document.querySelectorAll("[data-icon]")),aa=ja.next();!aa.done;aa=ja.next()){var Fb=aa.value;Fb.setAttribute("aria-hidden",!0)}}catch(b){r={error:b}}finally{try{aa&&!aa.done&&(t=ja.return)&&t.call(ja)}finally{if(r)throw r.error}}})();
